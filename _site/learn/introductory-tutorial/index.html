<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.2 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Sounds from Sensors with Mozzi - Mozzi</title>
<meta name="description" content="audio synthesis library for Arduino">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_GB">
<meta property="og:site_name" content="Mozzi">
<meta property="og:title" content="Sounds from Sensors with Mozzi">
<meta property="og:url" content="http://localhost:4000/Mozzi/learn/introductory-tutorial/">


  <meta property="og:description" content="audio synthesis library for Arduino">



  <meta property="og:image" content="http://localhost:4000/Mozzi/assets/images/mozzi-square.png">









  

  


<link rel="canonical" href="http://localhost:4000/Mozzi/learn/introductory-tutorial/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Tim Barrass",
      "url": "http://localhost:4000/Mozzi",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/Mozzi/feed.xml" type="application/atom+xml" rel="alternate" title="Mozzi Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/Mozzi/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/Mozzi/">Mozzi</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/Mozzi/download/" >download</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/gallery/" >gallery</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/examples/" >examples</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/learn/" >learn</a>
            </li><li class="masthead__menu-item">
              <a href="https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!forum/mozzi-users" >forum</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/blog/" >blog</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/doc/html/" >api</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/sensorium/Mozzi" >github</a>
            </li><li class="masthead__menu-item">
              <a href="/Mozzi/shop/" >shop</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style=" background-image: url('/Mozzi/assets/images/mozzi-square.png');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          Sounds from Sensors with Mozzi

        
      </h1>
      
        <p class="page__lead">audio synthesis library for Arduino
</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  

  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Sounds from Sensors with Mozzi">
    <meta itemprop="description" content="audio synthesis library for Arduino">
    
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <h1 id="sounds-from-sensors-with-mozzi">Sounds from Sensors with Mozzi</h1>

<h2 id="1-parts-list">1. Parts list</h2>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig1.jpg" alt="Parts" /></p>

<p><em>Figure 1: Parts used in the tutorial</em></p>

<p>Arduino Nano or clone<br />
Knob<br />
Switch<br />
LDR x 2<br />
Piezo<br />
5.1K resistor X 2<br />
10K resistor<br />
1M resistor<br />
Red wire x 3<br />
Black or White wire x 4<br />
Yellow or Orange wire x 4<br />
Blue wire<br />
Audio socket<br />
Audio cable<br />
USB cable</p>

<hr />

<h2 id="2-arduino">2. Arduino</h2>

<p>Push the Nano into the breadboard with top left leg of the USB end at <strong>c1</strong>.
Plug a mini USB cable into the Nano and connect it to your computer.</p>

<p><em>Figure 2: Nano on breadboard</em></p>

<p><img src="images/fig2.jpg" alt="Nano" title="Figure 2: Nano on breadboard" /></p>

<ul>
  <li>Download the <a href="https://www.arduino.cc">Arduino application</a>, version 1.0.5 or better.</li>
  <li>Download and install <a href="https://www.ftdichip.com/Drivers/VCP.htm">FTDI drivers</a> so Arduino can access the USB port.</li>
  <li>Start the Arduino application and set it up for a Nano clone.
<em>Arduino➞Tools➞Board➞Arduino Nano w/ Atmega 328</em></li>
  <li>Set it up to communicate through the USB port.
<em>Arduino➞Tools➞Serial Port➞usbserial</em></li>
</ul>

<p>Let’s test it by uploading a program into the Nano through the USB serial port.  <em>Arduino➞File➞Examples➞Blink</em> and press the ➜ <em>(upload)</em> button to upload the program to the Nano.</p>

<p>The red light on your nano should be blinking once per second.
Edit the code to make the light blink twice as fast by changing the delay from 1000ms to 500ms.  Yay, it works.</p>

<hr />

<h2 id="3-mozzi">3. Mozzi</h2>

<h3 id="software">Software</h3>

<p>OK - now the Arduino is working we are ready to install Mozzi.</p>

<ul>
  <li><a href="https://sensorium.github.io/Mozzi/">Download Mozzi</a> from Github.</li>
  <li>Now let’s import Mozzi into the Arduino system.<br />
Go <em>Arduino➞Sketch➞Import Library➞Add Library</em> and select the Mozzi.zip file from your Downloads folder.</li>
  <li>You should now be able to see Mozzi in the list under
<em>Arduino➞Sketch➞Import Library</em>.</li>
</ul>

<hr />

<h3 id="wiring">Wiring</h3>

<p>When we wire things together on the breadboard let’s all use a common wire colour protocol.</p>

<p>+V ⇒ RED<br />
-V ⇒ BLACK or WHITE<br />
INPUTS ⇒ YELLOW or ORANGE<br />
AUDIO ⇒  BLUE</p>

<p>Unplug the USB cable so that there is no power, just in case you plug a wire into the wrong place.</p>

<p>First let’s set up the power rails.</p>

<p><em>Figure 3: 5V and GND pins connected to +V and -V rails</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig3.jpg" alt="Power" /></p>

<ul>
  <li>Unplug the USB cable (!)</li>
  <li>Push a black wire into <strong>b14</strong> which is <strong>GND</strong> on the Nano.</li>
  <li>Push the other end into the <strong>-V</strong> rail on the left of the board at row <strong>14</strong>.</li>
  <li>Push another black wire into the top of the left hand <strong>-V</strong> rail  and connect it across the board to the top of the right hand  <strong>-V</strong> rail.</li>
  <li>Push a red wire into <strong>b12</strong> that connects to the <strong>5V</strong> pin on the Nano.</li>
  <li>Push the other end into the left  <strong>+V</strong> rail at row <strong>14</strong>.</li>
  <li>Push another red wire into the top left  <strong>+V</strong> rail and connect it to the top of the right  <strong>+V</strong> rail.</li>
</ul>

<p>Now let’s add a headphone socket so we can listen to sounds synthed on the Nano.</p>

<p><em>Figure 4: Audio socket connected to PWM Audio Output Pin D9</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig4.jpg" alt="Audio" /></p>

<ul>
  <li>Push the headphone socket into the bottom right hand corner of the breadboard at <strong>g26-g30</strong>.</li>
  <li>Push a blue wire into <strong>h4</strong> that connects to the audio output pin <strong>D9</strong> on the Nano.</li>
  <li>Push the other end of the blue wire into <strong>f26</strong> which is the tip of the audio socket.</li>
  <li>Push a black wire into  f28  to connect the <strong>GND</strong> on the audio socket and push the other end into the righthand  <strong>-V</strong> rail.</li>
</ul>

<p>Connect the audio cable to the audio output socket and the other end to the audio input on your computer.</p>

<hr />

<h3 id="audio-set-up">Audio set up</h3>

<p>You can listen to the sound on your computer by downloading and installing <a href="https://www.audacityteam.org/download/">Audacity</a>, a cross platform audio editor.</p>

<p>In Audacity,</p>

<ul>
  <li>set the <em>Input</em> to <strong>Built-in Input, 1 (Mono)</strong>.</li>
  <li>in the <em>Project Rate (Hz)</em> box, type <strong>16384</strong>.  This is Mozzi’s sample rate and will help show your waveforms clearly, otherwise they’ll appear as scrambled, aliased Pulse Width Modulated square waves.</li>
</ul>

<p>Some new laptops have a single audio socket that requires a 4-pole audio input cable. If you don’t have the cable then just listen to the audio through headphones which will be a bit noisy but good enough for learning….</p>

<hr />

<h3 id="testing-mozzi">Testing Mozzi</h3>

<p>Let’s test that it works with an example from the Mozzi library.</p>

<ul>
  <li><em>Arduino➞File➞Examples➞Mozzi➞01.Basics➞Sinewave</em></li>
  <li>Connect the USB cable to your Nano and upload the code.</li>
  <li>Press the Record button in Audacity to hear the sound and adjust the input level slider to avoid distortion.</li>
  <li>For a more interesting example of the sounds that Mozzi can make,
<em>Arduino➞File-Examples➞Mozzi➞09.Delays➞ReverbTank_STANDARD</em></li>
</ul>

<p>Try some of the other examples in the filters, delays, synthesis and sample folders to get a feel for what can be done.</p>

<hr />

<h2 id="4-sensors">4. Sensors</h2>

<p>Now let’s move on the next stage of sensing some input.</p>

<h3 id="a-knob">A Knob</h3>
<p>A knob (variable resistor, potentiometer or pot) has a middle connection which can be moved across a resistor, changing the resistance between the sweeping pin and each end.</p>

<p>Let’s make a circuit using a knob as a sensor.</p>

<p><em>Figure 5: Knob as input to Analog Pin A0</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig5.jpg" alt="Knob" /></p>

<ul>
  <li>Unplug the USB cable to unpower the Nano.</li>
  <li>Push the 3 legs of the knob into the board at <strong>j18, j20 and j22</strong>, with the rotating part facing right.</li>
  <li>Connect a red wire from one end of the pot at <strong>f18</strong> to the <strong>+V</strong> rail.</li>
  <li>Add an orange wire from the centre pin of the pot at <strong>f20</strong> to <strong>b4</strong> which connects to analog input pin <strong>A0</strong> of the Nano.</li>
  <li>Add a black wire from the remaining leg of the potentiometer at <strong>f22</strong> to the <strong>-V</strong> rail.</li>
</ul>

<p>Now the voltage on the analog input will go up and down as the knob is turned.  Let’s use the knob to change the sound volume in a Mozzi sketch.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Volume_Knob</em></p>

<p>This program reads the voltage on Analog pin 0 as an integer from 0-1023.</p>

<ul>
  <li>Click the Monitor button (magnifying glass) on the top right of the Arduino programming environment to read the value.</li>
  <li>In the monitor window, select <strong>115200</strong> baud to match the baud rate setup in the code.   Now a stream of numbers should scroll down the monitor, varying between 0-1023 as you rotate the knob.</li>
</ul>

<hr />

<h3 id="light-dependent-resistors">Light Dependent Resistors</h3>

<p>A Light Dependent Resistor (LDR) changes resistance with the light level. Let’s use that to control an FM synthesis algorithm.</p>

<p>First, we’ll make the sensor circuit using a LDR and a 5.1k Resistor (green-brown-black-brown) as a voltage ladder as input to the Analog Input on the Nano.</p>

<p><em>Figure 6: LDR + resistor as input to Analog Pin A1</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig6.jpg" alt="LDR" /></p>

<ul>
  <li>Unplug the USB cable to unpower the Nano.</li>
  <li>Push one leg of the LDR into <strong>a20</strong> and the other leg into the <strong>+V</strong> rail.</li>
  <li>Connect an orange wire from the LDR at <strong>b20</strong> to <strong>b5</strong> which connects to the analog pin <strong>A1</strong> of the Nano.</li>
  <li>Push one leg of the 5.1k resistor into <strong>a5</strong> and the other leg into the <strong>-V</strong> rail.</li>
</ul>

<p>Now the voltage on the analog input will go up and down with the light level.  The resistor stops high current draw on the USB port when the resistance of the LDR goes low.</p>

<p>Let’s test the LDR in a Mozzi sketch.<br />
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Volume_Knob_LightLevel_Frequency</em></p>

<p>This program adds the LDR to the previous example, reading the voltage on Analog pin 1 to change the frequency of the sinewave.  Use the Serial Monitor in the Arduino IDE to have a look at the numbers from the LDR.  They should range somewhere between about 300-1000.  Feel free to calibrate the sensor by changing the number mapping from the LDR to the oscillator frequency in the sketch.</p>

<p>Let’s try using the knob and LDR to modulate FM synthesis parameters.
The knob sets the fundamental (or <em>carrier</em>) frequency and the LDR changes the modulation width, which affects the brightness of the sound.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Knob_LightLevel_FMsynth</em></p>

<p>Wow.  Try to stay calm.  We’re gonna make it twice as fun by adding another light level input to the FM synth.</p>

<p><em>Figure 7: LDR + resistor as input to Analog Pin A2</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig7.jpg" alt="LDR+resistor" /></p>

<ul>
  <li>Unplug the Nano to depower it.</li>
  <li>Push the leg of another LDR into <strong>a25</strong> and connect the other leg to   the <strong>+V</strong> rail as before.</li>
  <li>Add an orange wire from the LDR at <strong>b25</strong> to <strong>b6</strong>, which connects to Nano Analog Input <strong>A2</strong>.</li>
  <li>Push one leg of the 5.1k resistor into <strong>a6</strong> and the other leg into the <strong>-V</strong> rail.</li>
</ul>

<p>Now upload the dual LDR + knob input FM synth into the Nano.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Knob_LightLevel_x2_FMsynth</em></p>

<p>The three inputs will produce a range of vibratos and timbre modulations that are great fun to mess around with (depending on how excitable you are).  In the sketch, you can calibrate your own mappings from the sensors to the synthesis wherever you see “calibrate” in the comments.</p>

<p>The same inputs can be used to play lots of different kinds of synthesis.  Here’s another sketch using the knob and two LDRs.  This one makes vocal-like sounds using wavepacket synthesis.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞LDR_x2_Knob_WavePacket</em></p>

<hr />

<h3 id="piezo">Piezo</h3>

<p>A piezo creates a varying voltage when you squeeze it.  We’ll use it as a sensor by measuring the voltage the piezo produces across a 1 megaOhm resistor (brown-black-black-yellow).</p>

<p><em>Figure 8: Piezo + resistor as input to Analog Pin A3</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig8.jpg" alt="Piezo" /></p>

<ul>
  <li>Unplug the Nano to depower it.</li>
  <li>It can be a good idea to wrap some sticky tape around the piezo where the wires are soldered on, to protect the fragile connections.</li>
  <li>Plug the red wire of the piezo into <strong>a30</strong> and the black wire into the <strong>-V</strong> rail.</li>
  <li>Add an orange wire from the piezo at <strong>b30</strong> to <strong>b7</strong> which connects to Nano analog input <strong>A3</strong>.</li>
  <li>Push one leg of the 1 megaOhm resistor into <strong>a7</strong> and the other leg into the <strong>-V</strong> rail.</li>
</ul>

<p>First, let’s get a feel for the piezo’s response with a simple patch.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Piezo_Frequency</em></p>

<p>Press on the piezo, tap it and scrape it to hear what it does.  Notice it has a very fast response, especially a sharp attack and decay when it’s knocked.  There are a couple of commented-out modifications in the sketch which can be uncommented to play around with the dynamics of the piezo signal.</p>

<p>Now we’ll use the sharp attack of the piezo to trigger a recorded audio sample to play, and for fun we can twist the knob to change the playback rate.
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Piezo_SampleTrigger</em></p>

<p>The next sketch uses pressure on the piezo to scrub through a sample by changing the starting position.  It’s crude, but you get the idea…
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Piezo_SampleScrubber</em></p>

<hr />

<h3 id="button">Button</h3>

<p>So far all of the sensor inputs have been analog.  Now we’ll add a digital input with a Button and a 10k Resistor (brown-black-black-red).</p>

<p><em>Figure 9: Button + resistor as input to Digital Pin D4</em></p>

<p><img src="/Mozzi/learn/introductory-tutorial/images/fig9.jpg" alt="Button" /></p>

<ul>
  <li>Unplug the Nano to depower it.</li>
  <li>Push the button into the breadboard with one leg in <strong>j9</strong> which connects to digital input <strong>D4</strong>, and the other leg in the <strong>+V</strong> rail.</li>
  <li>Add the 10k resistor from <strong>h9</strong> to the <strong>-V</strong> rail.</li>
</ul>

<p>When the button is pressed, the digital pin is connected to <strong>+V</strong>, and the voltage at the pin will be high.  When the button is not pressed, the pin is pulled to <strong>-V</strong> through the resistor and will be read as low by the Nano.</p>

<p>Let’s use the button to change the pitch of a sample trigger by the piezo.<br />
<em>Arduino➞File➞Examples➞Mozzi➞03.Sensors➞Piezo_Switch_Pitch</em></p>

<p>You can think of a better use for a switch than that!</p>

<hr />

<h2 id="5-go-to-town">5. Go to town</h2>

<p>Now we’ve got some experience using sensors to generate sounds, it’s time to expand the frontiers of sensor-based microsynthesis!</p>

<hr />

<h2 id="6-resources">6. Resources</h2>

<p><a href="https://sensorium.github.io/Mozzi/doc/html/index.html">Mozzi Programming Reference</a><br />
<a href="https://sensorium.github.io/Mozzi/learn/output/">Output circuits for cleaner sounding audio</a><br />
<a href="https://sensorium.github.io/Mozzi/learn/hints/">Tips for effective Mozzi programming</a></p>

<hr />

<p>Tim Barrass and Stephen Barrass 2013. This work is licensed under the Creative Commons Attribution-NonCommercial- ShareAlike 3.0 Unported License. To view a copy of this license, visit https://creativecommons.org/licenses/by-nc-sa/3.0/.<br />
<img src="/Mozzi/learn/introductory-tutorial/images/by-nc-sa.png" alt="Creative Commons by-nc-sa logo" /></p>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
    
    
    <li><a href="/Mozzi/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Tim Barrass. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/Mozzi/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>








  </body>
</html>